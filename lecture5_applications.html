<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ì œ5ê°•: ì‹¤ì œ ì‘ìš© ì‚¬ë¡€ | ìˆ­ì‹¤ëŒ€ í™”í•™ê³¼</title>
    
    <script src="https://cdn.plot.ly/plotly-2.24.1.min.js"></script>
    
    <script>
        window.MathJax = {
            tex: { inlineMath: [['$', '$'], ['\\(', '\\)']] }
        };
    </script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">

    <style>
        :root { --primary: #667eea; --secondary: #764ba2; --accent: #ff9f43; --text-dark: #333; --bg-light: #f8f9fa; }
        body { font-family: 'Noto Sans KR', sans-serif; background: var(--bg-light); color: var(--text-dark); line-height: 1.6; margin: 0; padding: 0; }
        .container { max-width: 1000px; margin: 0 auto; padding: 20px; }
        .nav-header { background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%); color: white; padding: 20px; border-radius: 0 0 20px 20px; margin-bottom: 40px; display: flex; justify-content: space-between; align-items: center; box-shadow: 0 4px 15px rgba(102, 126, 234, 0.3); }
        .home-btn { color: white; text-decoration: none; font-weight: bold; }
        
        section { background: white; border-radius: 20px; padding: 40px; margin-bottom: 30px; box-shadow: 0 5px 20px rgba(0,0,0,0.05); }
        h2 { border-left: 5px solid var(--primary); padding-left: 15px; color: var(--secondary); margin-top: 0; }
        
        /* ì‘ìš© ë¶„ì•¼ ì¹´ë“œ ìŠ¤íƒ€ì¼ */
        .app-card { display: flex; gap: 20px; margin-bottom: 30px; align-items: center; background: #f1f3f5; padding: 20px; border-radius: 15px; }
        .app-icon { font-size: 2.5em; color: var(--primary); width: 60px; text-align: center; }
        .app-desc h3 { margin: 0 0 5px 0; color: var(--text-dark); }
        .app-desc p { margin: 0; color: #666; font-size: 0.95em; }

        /* ì»¨íŠ¸ë¡¤ íŒ¨ë„ */
        .control-panel { background: #333; color: white; padding: 20px; border-radius: 15px; margin-top: 20px; }
        .slider-group { margin-bottom: 15px; }
        .slider-group label { display: flex; justify-content: space-between; margin-bottom: 5px; font-weight: bold; }
        .slider-group input { width: 100%; cursor: pointer; }
        
        /* ë²„íŠ¼ ê·¸ë£¹ */
        .btn-group { display: flex; gap: 10px; justify-content: center; margin-top: 20px; }
        .action-btn {
            padding: 10px 20px; border: none; border-radius: 25px;
            font-weight: bold; cursor: pointer; transition: all 0.2s;
            background: #e9ecef; color: #495057;
        }
        .action-btn.active { background: var(--accent); color: white; transform: scale(1.05); box-shadow: 0 4px 10px rgba(255, 159, 67, 0.4); }
        .action-btn:hover { background: #dee2e6; }
        .action-btn.active:hover { background: var(--accent); }

        .prof-tip { background: #fff3cd; border: 1px solid #ffeeba; color: #856404; padding: 15px; border-radius: 10px; margin-top: 20px; }
    </style>
</head>
<body>

    <div class="container">
        <nav class="nav-header">
            <div>
                <h1 style="margin:0; font-size:1.5em;">ğŸš€ 05ê°•: ì‹¤ì œ ì‘ìš© ì‚¬ë¡€</h1>
                <p style="margin:5px 0 0 0; opacity:0.9;">ë°°í„°ë¦¬ë¶€í„° ë°”ì´ì˜¤ì„¼ì„œê¹Œì§€</p>
            </div>
            <a href="index.html" class="home-btn"><i class="fas fa-home"></i> ë©”ì¸ìœ¼ë¡œ</a>
        </nav>

        <section>
            <div class="app-card">
                <div class="app-icon"><i class="fas fa-car-battery"></i></div>
                <div class="app-desc">
                    <h3>1. ë¦¬íŠ¬ ì´ì˜¨ ë°°í„°ë¦¬ ì§„ë‹¨</h3>
                    <p>ë°°í„°ë¦¬ê°€ ë…¸í™”(Aging)ë˜ë©´ ë‚´ë¶€ ì €í•­ì´ ì–´ë–»ê²Œ ë³€í•˜ëŠ”ì§€ í™•ì¸í•´ë´…ì‹œë‹¤.</p>
                </div>
            </div>

            <div id="batteryPlot" style="width:100%; height:400px;"></div>
            
            <div class="control-panel">
                <div class="slider-group">
                    <label>
                        <span>ì¶©/ë°©ì „ ì‚¬ì´í´ (Aging)</span>
                        <span id="cycleValue" style="color: var(--accent);">0 Cycles (ìƒˆ ë°°í„°ë¦¬)</span>
                    </label>
                    <input type="range" id="cycleSlider" min="0" max="1000" step="50" value="0">
                </div>
                <p style="font-size: 0.9em; color: #ccc; margin-top: 10px;">
                    * ì‚¬ì´í´ì´ ì¦ê°€í• ìˆ˜ë¡ ì „í•´ì§ˆì´ ë§ˆë¥´ê³ ($R_s \uparrow$), SEI ì¸µì´ ë‘êº¼ì›Œì§€ë©°($R_{ct} \uparrow$) ë°°í„°ë¦¬ ì„±ëŠ¥ì´ ì €í•˜ë©ë‹ˆë‹¤.
                </p>
            </div>
        </section>

        <section>
            <div class="app-card">
                <div class="app-icon"><i class="fas fa-dna"></i></div>
                <div class="app-desc">
                    <h3>2. ë°”ì´ì˜¤ì„¼ì„œ (Label-free Detection)</h3>
                    <p>ì „ê·¹ í‘œë©´ì— í•­ì²´ì™€ í•­ì›ì´ ê²°í•©í•  ë•Œ, ì „ì ì´ë™ì´ ì–¼ë§ˆë‚˜ ë°©í•´ë°›ëŠ”ì§€($R_{ct}$ ì¦ê°€) ì¸¡ì •í•©ë‹ˆë‹¤.</p>
                </div>
            </div>

            <div id="bioPlot" style="width:100%; height:400px;"></div>

            <div class="btn-group">
                <button class="action-btn active" onclick="updateBioStep(1)">1. Bare Gold</button>
                <button class="action-btn" onclick="updateBioStep(2)">2. Antibody ê³ ì •</button>
                <button class="action-btn" onclick="updateBioStep(3)">3. Antigen ê²°í•© (ê²€ì¶œ)</button>
            </div>

            <div class="prof-tip">
                <strong>ğŸ‘¨â€ğŸ« êµìˆ˜ë‹˜ì˜ ì½”ë©˜íŠ¸:</strong><br>
                ì„ì‹ ì¤‘ë…ì¦ ë§ˆì»¤ ë‹¨ë°±ì§ˆì´ í•­ì²´ì— ë¶™ìœ¼ë©´ ì „ìê°€ ì§€ë‚˜ë‹¤ë‹ í‹ˆì´ ì¢ì•„ì§‘ë‹ˆë‹¤. <br>
                ì¦‰, <strong>ë°˜ì›ì´ ì»¤ì§ˆìˆ˜ë¡ "ì–‘ì„±(Positive)"</strong>ì¼ í™•ë¥ ì´ ë†’ë‹¤ëŠ” ëœ»ì´ì£ !
            </div>
        </section>

        <section>
            <div class="app-card">
                <div class="app-icon"><i class="fas fa-shield-alt"></i></div>
                <div class="app-desc">
                    <h3>3. ê¸ˆì† ë¶€ì‹ê³¼ ì½”íŒ… í‰ê°€</h3>
                    <p>ì½”íŒ…ì´ ì˜ ë˜ì–´ ìˆìœ¼ë©´ ì €í•­ì´ ë§¤ìš° í½ë‹ˆë‹¤. ì½”íŒ…ì— í ì§‘(Defect)ì´ ìƒê¸°ë©´ ì–´ë–»ê²Œ ë ê¹Œìš”?</p>
                </div>
            </div>

            <div id="corrosionPlot" style="width:100%; height:400px;"></div>

            <div class="control-panel">
                <div class="slider-group">
                    <label>
                        <span>ì½”íŒ… ìƒíƒœ (Coating Quality)</span>
                        <span id="coatingValue" style="color: var(--accent);">ì™„ë²½í•¨ (100%)</span>
                    </label>
                    <input type="range" id="coatingSlider" min="1" max="100" step="1" value="100">
                </div>
                <div style="font-size: 0.9em; color: #ccc;">
                    ì™¼ìª½(0%)ìœ¼ë¡œ ê°ˆìˆ˜ë¡ ì½”íŒ…ì´ ë²—ê²¨ì ¸ ë¶€ì‹ì´ ë¹ ë¥´ê²Œ ì§„í–‰ë©ë‹ˆë‹¤. (ë°˜ì›ì´ ì‘ì•„ì§)
                </div>
            </div>
        </section>

        <p style="text-align: center; margin-top: 30px;">
            <a href="lecture6_troubleshooting.html" style="background: var(--primary); color: white; padding: 15px 30px; text-decoration: none; border-radius: 25px; font-weight: bold;">ë§ˆì§€ë§‰ ê°•ì˜: ì‹¤í—˜ ë…¸í•˜ìš° â†’</a>
        </p>
    </div>

    <script>
        document.addEventListener("DOMContentLoaded", function() {
            
            // --- 1. ë°°í„°ë¦¬ ì‹œë®¬ë ˆì´ì…˜ ë¡œì§ ---
            function updateBatteryPlot() {
                const cycles = parseInt(document.getElementById('cycleSlider').value);
                document.getElementById('cycleValue').innerText = cycles + " Cycles" + (cycles === 0 ? " (ìƒˆ ë°°í„°ë¦¬)" : "");

                // ë°°í„°ë¦¬ ë…¸í™” ëª¨ë¸: ì‚¬ì´í´ì´ ëŒìˆ˜ë¡ Rs ì•½ê°„ ì¦ê°€, Rct ëŒ€í­ ì¦ê°€
                // Aging Factor
                const alpha = cycles / 1000; 
                const Rs = 5 + (2 * alpha); // 5ì˜´ -> 7ì˜´ (ì „í•´ì§ˆ ê±´ì¡°)
                const Rct = 20 + (100 * alpha * alpha); // 20ì˜´ -> 120ì˜´ (ê³„ë©´ ì €í•­ ê¸‰ì¦)
                const Cdl = 0.001;

                const x = [], y = [];
                for(let f=10000; f>=0.1; f/=1.5) {
                    const w = 2 * Math.PI * f;
                    const denom = 1 + Math.pow(w * Rct * Cdl, 2);
                    x.push(Rs + Rct/denom);
                    y.push((w * Rct * Rct * Cdl)/denom);
                }

                Plotly.newPlot('batteryPlot', [{
                    x: x, y: y, mode: 'lines+markers',
                    marker: {size: 6, color: cycles, colorscale: 'Hot', cmin:0, cmax:1000},
                    line: {color: '#ff7675', width: 3}
                }], {
                    title: 'ë°°í„°ë¦¬ ë…¸í™”ì— ë”°ë¥¸ ì„í”¼ë˜ìŠ¤ ë³€í™”',
                    xaxis: {title: "Z' (Î©)", range: [0, 150]},
                    yaxis: {title: "-Z'' (Î©)", scaleanchor: "x", scaleratio: 1, range: [0, 80]},
                    margin: {t:40, b:40, l:50, r:20},
                    plot_bgcolor: "#fff"
                }, {responsive: true});
            }
            document.getElementById('cycleSlider').addEventListener('input', updateBatteryPlot);
            updateBatteryPlot(); // ì´ˆê¸° ì‹¤í–‰


            // --- 2. ë°”ì´ì˜¤ì„¼ì„œ ì‹œë®¬ë ˆì´ì…˜ ë¡œì§ ---
            window.updateBioStep = function(step) {
                // ë²„íŠ¼ ìŠ¤íƒ€ì¼ ì—…ë°ì´íŠ¸
                const btns = document.querySelectorAll('.action-btn');
                btns.forEach((btn, idx) => {
                    if(idx + 1 === step) btn.classList.add('active');
                    else btn.classList.remove('active');
                });

                // ë‹¨ê³„ë³„ íŒŒë¼ë¯¸í„° ì„¤ì •
                let Rs = 10;
                let Rct = 50; // ê¸°ë³¸ (Bare)
                let label = "Bare Gold";
                let color = "#bdc3c7";

                if(step === 2) {
                    Rct = 200; // í•­ì²´ ê³ ì • í›„ ì €í•­ ì¦ê°€
                    label = "Antibody Immobilized";
                    color = "#f1c40f";
                } else if(step === 3) {
                    Rct = 600; // í•­ì› ê²°í•© í›„ ì €í•­ ëŒ€í­ ì¦ê°€
                    label = "Antigen Bound (Detected!)";
                    color = "#e74c3c";
                }

                const Cdl = 0.0001;
                const x = [], y = [];
                
                // Warburg íš¨ê³¼ (45ë„ ì§ì„ ) ì¶”ê°€ë¥¼ ìœ„í•´ ì €ì£¼íŒŒìˆ˜ ëŒ€ì—­ ì²˜ë¦¬
                for(let f=100000; f>=0.1; f/=1.5) {
                    const w = 2 * Math.PI * f;
                    // Randles with Warburg (Simplified approximation for visual)
                    // Z_warburg = sigma / sqrt(w) * (1-j)
                    const sigma = 50; 
                    const zw_real = sigma / Math.sqrt(w);
                    const zw_imag = sigma / Math.sqrt(w);

                    // ë³‘ë ¬ íšŒë¡œ (Rct + Zw) || Cdl ê³„ì‚°ì€ ë³µì¡í•˜ë¯€ë¡œ 
                    // ì‹œê°í™”ë¥¼ ìœ„í•´ Rctë§Œ ë³€í•˜ëŠ” ë°˜ì› ëª¨ë¸ + ëì— í™•ì‚° ê¼¬ë¦¬ ë¶™ì´ê¸°
                    
                    const denom = 1 + Math.pow(w * Rct * Cdl, 2);
                    let z_real = Rs + Rct/denom;
                    let z_imag = (w * Rct * Rct * Cdl)/denom;

                    // ì €ì£¼íŒŒìˆ˜ì—ì„œ í™•ì‚°(ì§ì„ ) íš¨ê³¼ í‰ë‚´
                    if (f < 10) {
                        z_real += zw_real;
                        z_imag += zw_imag;
                    }

                    x.push(z_real);
                    y.push(z_imag);
                }

                Plotly.newPlot('bioPlot', [{
                    x: x, y: y, mode: 'lines', fill: 'tozeroy',
                    line: {color: color, width: 4},
                    name: label
                }], {
                    title: `ë°”ì´ì˜¤ì„¼ì„œ ë‹¨ê³„: ${label}`,
                    xaxis: {title: "Z' (Î©)", range: [0, 800]},
                    yaxis: {title: "-Z'' (Î©)", scaleanchor: "x", scaleratio: 1, range: [0, 500]},
                    margin: {t:40, b:40, l:50, r:20}
                }, {responsive: true});
            };
            window.updateBioStep(1); // ì´ˆê¸° ì‹¤í–‰


            // --- 3. ë¶€ì‹ ì‹œë®¬ë ˆì´ì…˜ ë¡œì§ ---
            function updateCorrosionPlot() {
                const quality = parseInt(document.getElementById('coatingSlider').value);
                
                // ì½”íŒ… í’ˆì§ˆ 100 -> Rct 10000 (ë§¤ìš° í¼)
                // ì½”íŒ… í’ˆì§ˆ 1 -> Rct 100 (ë¶€ì‹ ì§„í–‰)
                // Log scale mapping
                const Rct = 100 * Math.pow(10, (quality/50)); 
                const Rs = 10;
                const Cdl = 0.0001;

                document.getElementById('coatingValue').innerText = quality + "%";
                if(quality < 30) document.getElementById('coatingValue').style.color = "red";
                else document.getElementById('coatingValue').style.color = "var(--accent)";

                const x = [], y = [];
                for(let f=10000; f>=0.01; f/=2) {
                    const w = 2 * Math.PI * f;
                    const denom = 1 + Math.pow(w * Rct * Cdl, 2);
                    x.push(Rs + Rct/denom);
                    y.push((w * Rct * Rct * Cdl)/denom);
                }

                Plotly.newPlot('corrosionPlot', [{
                    x: x, y: y, type: 'scatter', mode: 'lines',
                    line: {color: '#3498db', width: 3}
                }], {
                    title: 'ì½”íŒ… í’ˆì§ˆì— ë”°ë¥¸ ì„í”¼ë˜ìŠ¤',
                    // ì½”íŒ… ì €í•­ì€ ë¡œê·¸ ìŠ¤ì¼€ì¼ë¡œ ë³€í•˜ë¯€ë¡œ ì¶• ë²”ìœ„ë¥¼ ë™ì ìœ¼ë¡œ ë³´ì—¬ì£¼ëŠ”ê²Œ ì¢‹ìŒ
                    xaxis: {title: "Z' (Î©)"},
                    yaxis: {title: "-Z'' (Î©)", scaleanchor: "x", scaleratio: 1},
                    margin: {t:40, b:40, l:50, r:20}
                }, {responsive: true});
            }
            document.getElementById('coatingSlider').addEventListener('input', updateCorrosionPlot);
            updateCorrosionPlot();
        });
    </script>
</body>
</html>